<!DOCTYPE html>
<html>
<head>
  <title>GeoDash</title>

  <meta name="viewport" content="width=device-width">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="./dist/geodash.min.css" />
  <script src="./dist/geodash.js"></script>
  <style>
    body {
      font-family: arial, sans-serif;
    }
    a {
      color: #b1b1b1;
    }
    .wrapper {
      margin: 20px auto;
      width: 700px;
    }
    .title h1 {
      float: left;
      font-size: 32px;
      margin: 0;
    }
    .title a {
      font-size: 14px;
      margin-top: 14px;
      float: right;
    }
    .description {
      color: #b1b1b1;
      font-size: 14px;
      margin: 20px 0 20px 0;
    }
    .description p {
      padding: 0 0 5px 0;
      margin: 0;
    }
    .charts {
      width: auto;
      margin: 0px auto;
      text-align: center;
      background: #dfdfdf;
      overflow: auto;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      display: inline-block;
    }
    .barcharthorizontal {
      width: 315px;
      height: 315px;
    }
    .barchartvertical {
      width: 315px;
      height: 315px;
    }
    .piechart {
      width: 315px;
      height: 315px;
    }
    .linechart {
      width: 315px;
      height: 315px;
    }
    .chart {
      float: left;
      background: #fff;
      margin: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      overflow: hidden;
    }
    .row {
      overflow: auto;
    }
    .barchart2 {
      width: 652px;
      height: 315px;
    }
    .barcharthorizontal2 {
      width: 652px;
      height: 315px;
    }
    .linechart2 {
      width: 652px;
      height: 315px;
    }
    #randomize4 {
      float: left;
      margin-left: 140px;
    }
  </style>
</head>
<body>
<div class="wrapper">
  <div class="row title">
    <h1>GeoDash</h1>
  </div>
  <div class="row description">
    <p>A charting library.</p>
    <p>Documentation on <a href="https://github.com/esrgc/geodash">Github</a>.</p>
    <p>By <a href="https://twitter.com/fsrowe">@fsrowe</a>.</p>
  </div>
  <div class="charts">
    <div class="row">
      <div class="barchartvertical chart"></div>
      <div class="barcharthorizontal chart"></div>
    </div>
    <div class="row">
      <div class="piechart chart"></div>
      <div class="linechart chart"></div>
      <button id="randomize4">New Pie Data</button>
    </div>
    <div class="row">
      <div class="barchart2 chart"></div>
      <button id="randomize">New Data</button>
      <button id="sort">Sort</button>
    </div>
    <div class="row">
      <div class="barcharthorizontal2 chart"></div>
      <button id="randomize2">New Data</button>
      <button id="sort2">Sort</button>
    </div>
    <div class="row">
      <div class="linechart2 chart"></div>
      <button id="randomize3">New Data</button>
    </div>

  </div>
</div>
  <script type="text/javascript">

    var colors = ["#ef3b2c","#cb181d","#a50f15"].reverse()

    function makeid() {
      var text = ""
        , possible = "abcdefghijklmnopqrstuvwxyz";
      for( var i=0; i < 5; i++ ) {
        text += possible.charAt(Math.floor(Math.random() * possible.length))
      }
      return text
    }

    function randomize() {
      var datalength = Math.floor((Math.random()*10)+1)
      var newdata = []
      for (var i = 0; i <= datalength; i++) {
        var obj = {}
        obj.value = Math.floor((Math.random()*100)+1)
        obj.id = makeid()
        newdata.push(obj)
      }
      var addnegative = Math.floor((Math.random()*4)+1)
      if(addnegative === 2) {
        newdata[Math.floor((Math.random()*datalength)+1)].value *= -1
      }
      return newdata
    }

    function randomizeLine() {
      var newdata = linedata
      for (var i = 0; i < newdata.length; i++) {
        newdata[i].numCats = Math.floor((Math.random()*150000)+1)
      }
      return newdata
    }

    function sort(data){
      data.sort(function(a, b) {
        if (a.value > b.value)
          return 1
        if (a.value < b.value)
          return -1
        return 0
      })
      return data
    }


    var piechart = new GeoDash.PieChart('.piechart', {
      label: 'id',
      value: 'value',
      colors: colors,
      opacity: 0.8,
      innerRadius: 10,
      legend: true,
      title: 'Pie Chart',
      arclabels: false,
      legendWidth: 60
    });

    var piedata = [{
        "id":"lol",
        "value":33
      },{
        "id":"cats",
        "value":11
      },{
        "id":"cool",
        "value":2
    }];

    piechart.update(piedata);
    document.getElementById('randomize4').onclick = function() {
      piechart.update(randomize())
    }

    var parseDate = d3.time.format("%Y").parse;
    var linechart = new GeoDash.LineChart(".linechart", {
      x: 'date',
      y: ['numCats', 'goalCats'],
      width: 'auto',
      height: 'auto',
      colors: colors,
      title: 'Line Chart',
      interpolate: 'monotone',
      dotRadius: 3,
      xInterval: 5,
      xFormat: d3.time.format("%Y"),
      dashed: [{
        line: 0,
        span: {
          start: 1,
          howMany: 3
        }
      }]
    });

    var linedata = [{
        "date":parseDate("2007"),
        "numCats":92817,
        "goalCats": 100000
      },{
        "date":parseDate("2008"),
        "numCats":82705,
        "goalCats": 100000
      },{
        "date":parseDate("2009"),
        "numCats":75920,
        "goalCats": 100000
      },{
        "date":parseDate("2010"),
        "numCats":76920,
        "goalCats": 100000
      },{
        "date":parseDate("2011"),
        "numCats":84123,
        "goalCats": 100000
      },{
        "date":parseDate("2012"),
        "numCats":99109,
        "goalCats": 100000
      },{
        "date":parseDate("2013"),
        "numCats":145897,
        "goalCats": 100000
    }];

    linechart.update(linedata);

    var data = [
    {
      "geo": "Allegany",
      "geocode": "1",
      "2011": "74,692",
      "2012": "73,692",
      "2013": "444403"
    },
    {
      "geo": "Anne Arundel",
      "geocode": "3",
      "2011": "544403",
      "2012": "444403",
      "2013": "444403"
    },
    {
      "geo": "Baltimore City",
      "geocode": "510",
      "2011": "619493",
      "2012": "519493",
      "2013": "444403"
    },
    {
      "geo": "Baltimore",
      "geocode": "5",
      "2011": "809941",
      "2012": "709941",
      "2013": "444403"
    },
    {
      "geo": "Calvert",
      "geocode": "9",
      "2011": "89256",
      "2012": "79256",
      "2013": "444403"
    },
    {
      "geo": "Caroline",
      "geocode": "11",
      "2011": "32985",
      "2012": "22985",
      "2013": "444403"
    }
  ];

    var barcharthtml = new GeoDash.BarChartHorizontal('.barcharthorizontal', {
      x: ['2011', '2012', '2013'],
      y: 'geo',
      barColors: colors,
      title: 'Horizontal Bar Chart',
      drawX: true,
      drawY: true,
      money: true,
      numberTicks: 5,
      yWidth: 60,
      hoverTemplate: "{{y}}: ${{x}}"
    });
    barcharthtml.update(data);

    var data = [
      {
        "id": "Mon",
        "2011": "42235.7",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Tue",
        "2011": "165113.8",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Wed",
        "geocode": "45",
        "2011": "64447.3",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Thu",
        "2011": "12444.0",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Fri",
        "2011": "22444.0",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Sat",
        "2011": "62444.0",
        "2012": "42235.7",
        "2013": "42235.7"
      },
      {
        "id": "Sun",
        "2011": "92444.0",
        "2012": "42235.7",
        "2013": "42235.7"
      }
    ]

    var barchartvertical = new GeoDash.BarChartVertical('.barchartvertical', {
      x: 'id',
      y: ['2011', '2012', '2013'],
      barColors: colors,
      title: 'Vertical Bar Chart',
      legendWidth: 60,
      drawX: true,
      drawY: true
    });

    barchartvertical.update(data);

    var barchart2 = new GeoDash.BarChartVertical('.barchart2', {
      x: 'id',
      y: 'value',
      barColors: colors,
      title: 'Update Bar Chart',
      drawX: true,
      drawY: true,
      yLabel: 'Y Axis Label',
      xLabel: 'X Axis Label',
      opacity: .7
    });
    barchart2.update(randomize());
    document.getElementById('randomize').onclick = function() {
      barchart2.update(randomize())
    }
    document.getElementById('sort').onclick = function() {
      var data = barchart2.getData()
      barchart2.update(sort(data))
    }

    var barcharthorizontal2 = new GeoDash.BarChartHorizontal('.barcharthorizontal2', {
      x: 'value',
      y: 'id',
      barColors: colors,
      title: 'Horizontal Bar Chart',
      drawX: true,
      drawY: true,
      verticalX: true,
      numberTicks: 5,
      yLabel: 'Y Axis Label',
      xLabel: 'X Axis Label',
      yWidth: 40
    });
    barcharthorizontal2.update(randomize())
    document.getElementById('randomize2').onclick = function() {
      barcharthorizontal2.update(randomize())
    }
    document.getElementById('sort2').onclick = function() {
      var data = barcharthorizontal2.getData()
      barcharthorizontal2.update(sort(data))
    }

    var linechart2 = new GeoDash.LineChart(".linechart2", {
      x: 'date',
      y: ['numCats', 'goalCats'],
      width: 'auto',
      height: 'auto',
      colors: ["#930000", "#ff4d4d"],
      title: 'Line Chart',
      interpolate: 'monotone',
      dotRadius: 3,
      xInterval: 5,
      yLabel: 'Number of Cats',
      xFormat: d3.time.format("%Y"),
      dashed: [{
        line: 1,
        span: [{
          start: 0,
          end: 2
        }]
      }]
    })

    linechart2.update(linedata)
    document.getElementById('randomize3').onclick = function() {
      linechart2.update(randomizeLine())
    }
  </script>
</body>
</html>